!function(){"use strict";const e={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},t=document.querySelector(".profile__edit-button"),s=document.querySelector(".form_type_edit"),r=s.querySelector(".form__input_type_name"),n=s.querySelector(".form__input_type_info"),o=document.querySelector(".profile__add-button"),i=document.querySelector(".form_type_add-card"),a=document.querySelector(".form_type_edit-avatar"),l=document.querySelector(".profile__avatar");class c{constructor(e,t,s,r,n,o,i){this._image=e.link,this._title=e.name,this._alt=e.alt,this._likes=e.likes,this._id=e._id,this._userId=t,this._ownerId=s,this._cardSelector=r,this._handleCardClick=n,this._handleLikeButton=o,this._handleDeleteCardButton=i}getId(){return this._id}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}isLiked(){return this._likes.find((e=>e._id===this._userId))}setLikes(e){this._likes=e;const t=this._likes.length;this._cardElement.querySelector(".card__like-counter").textContent=t,this.isLiked()?this._cardElement.querySelector(".card__like").classList.add("card__like_active"):this._cardElement.querySelector(".card__like").classList.remove("card__like_active")}deleteCard(){this._cardElement.remove(),this._cardElement=null}_setEventListeners(){this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteCardButton())),this._cardElement.querySelector(".card__like").addEventListener("click",this._handleLikeButton),this._cardElement.querySelector(".card__picture").addEventListener("click",this._handleCardClick)}generateCard(){this._cardElement=this._getTemplate();const e=this._cardElement.querySelector(".card__picture"),t=this._cardElement.querySelector(".card__description");this.setLikes(this._likes);const s=this._cardElement.querySelector(".card__delete-button");return this._userId!==this._ownerId&&s.classList.add("card__delete-button_disabled"),e.src=this._image,e.alt=this._alt,t.textContent=this._title,this._setEventListeners(),this._cardElement}}class d{constructor(e,t){this._config=e,this._formElement=t,this._buttonElement=this._formElement.querySelector(this._config.submitButtonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._config.inputSelector))}_showInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._config.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._config.inputErrorClass),t.textContent="",t.classList.remove(this._config.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_setButtonToDisabledState(){this._buttonElement.classList.add(this._config.inactiveButtonClass),this._buttonElement.disabled=!0}_setButtonToEnabledState(){this._buttonElement.classList.remove(this._config.inactiveButtonClass),this._buttonElement.disabled=!1}_changeButtonState(e){this._hasInvalidInput(e)?this._setButtonToDisabledState(this._buttonElement):this._setButtonToEnabledState(this._buttonElement)}_setEventListeners(){const e=Array.from(this._formElement.querySelectorAll(this._config.inputSelector));this._changeButtonState(e,this._buttonElement),e.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._changeButtonState(e,this._buttonElement)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>e.preventDefault)),this._setEventListeners()}resetFormValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._setButtonToDisabledState()}}function _(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class u{constructor(e){_(this,"_handleEscClose",(e=>{"Escape"===e.key&&this.close()})),_(this,"_handleMouseClick",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-button"))&&this.close()})),this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("popup_opened"),this._setEventListeners()}close(){this._popupElement.classList.remove("popup_opened"),this._removeEventListeners()}_setEventListeners(){this._popupElement.addEventListener("mousedown",this._handleMouseClick),document.addEventListener("keydown",this._handleEscClose)}_removeEventListeners(){this._popupElement.removeEventListener("mousedown",this._handleMouseClick),document.removeEventListener("keydown",this._handleEscClose)}}class h extends u{constructor(e,t,s){super(e),this._handleSubmit=t,this._formValidator=s,this._formElement=this._popupElement.querySelector(".form")}getInputValues(){const e=Array.from(this._popupElement.querySelectorAll(".form__input")),t={};return e.forEach((e=>{t[e.name]=e.value})),t}open(){super.open(),this._formValidator.resetFormValidation()}close(){super.close(),this._formElement.reset()}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction()}))}}const m=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(this._baseUrl+"/user/me",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}getInitialCards(){return fetch(this._baseUrl+"/cards",{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}addCard(e,t){return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}addLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}removeLike(e){return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}deleteCard(e){return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers})}editProfilePhoto(e){return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}editProfileInfo(e,t){return fetch(this._baseUrl+"/user/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject("Error: ".concat(e.status)))).catch((e=>console.log(e)))}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"c0d07090-8c80-49c2-aa7a-cd5677a34984","Content-Type":"application/json"}}),p=new d(e,s),E=new d(e,i),f=new d(e,a);let b;p.enableValidation(),E.enableValidation(),f.enableValidation();const v=e=>{const t=new c(e,L,e.owner._id,"#card",(()=>(e=>{k.open(e.link,e.name)})(e)),(()=>{t.isLiked()?m.removeLike(t.getId()).then((e=>{t.setLikes(e.likes)})):m.addLike(t.getId()).then((e=>{t.setLikes(e.likes)}))}),(()=>{w.open(),b=t}));return t.generateCard()},y=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._section=document.querySelector(t)}addItem(e){this._section.append(e)}renderCards(e){e.forEach((e=>{this._renderer(e)}))}}({renderer:e=>{y.addItem(v(e))}},".gallery__list");let L;Promise.all([m.getUserInfo(),m.getInitialCards()]).then((e=>{let[t,s]=e;L=t._id,S.setUserInfo(t),l.src=t.avatar,y.renderCards(s)}));const S=new class{constructor(e,t){this._nameField=document.querySelector(e),this._jobField=document.querySelector(t)}getUserInfo(){return{name:this._nameField.textContent,job:this._jobField.textContent}}setUserInfo(e){this._nameField.textContent=e.name,this._jobField.textContent=e.about}}(".profile__name",".profile__about"),k=new class extends u{constructor(e){super(e)}open(e,t){super.open();const s=document.querySelector(".popup-picture-box__image"),r=document.querySelector(".popup-picture-box__caption");s.src=e,s.alt="Here was a beautiful picture of ".concat(t),r.textContent=t}}(".popup_type_picture");function g(e){const t=e.textContent;return e.textContent="Saving...",t}const C=new h(".popup_type_edit",(()=>{const e=s.querySelector(".form__submit-button"),t=g(e);m.editProfileInfo(C.getInputValues()).then((e=>{S.setUserInfo(e)})).finally((()=>{C.close(),e.textContent=t}))}),p);C.setEventListeners();const I=new h(".popup_type_add-card",(()=>{const e=I.getInputValues(),t=i.querySelector(".form__submit-button"),s=g(t);m.addCard(e.name,e.link).then((e=>{y.addItem(v(e))})).finally((()=>{I.close(),t.textContent=s})),e.alt="Here was a beautiful picture of ".concat(e.name)}),E),q=new h(".popup_type_edit-avatar",(()=>{const e=a.querySelector(".form__submit-button"),t=g(e);m.editProfilePhoto(q.getInputValues().avatar).then((e=>{l.src=e.avatar})).finally((()=>{q.close(),e.textContent=t}))}),f);q.setEventListeners();const w=new class extends u{constructor(e,t){super(e),this._submitFunction=t}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._submitFunction()}))}}(".popup_type_delete-card",(()=>{m.deleteCard(b.getId()).finally(w.close()),b.deleteCard()}));w.setEventListeners(),t.addEventListener("click",(()=>{(()=>{const e=S.getUserInfo();r.value=e.name,n.value=e.job})(),C.open()})),o.addEventListener("click",(()=>I.open())),l.addEventListener("click",(()=>q.open()))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyxFQUFrQm9ELGlCQUFpQixTQUFTLEtBUGxCLE1BQzFCLE1BQU13SSxFQUFPdEIsRUFBUy9DLGNBQ3RCbkgsRUFBZXlHLE1BQVErRSxFQUFLckssS0FDNUJsQixFQUFld0csTUFBUStFLEVBQUtoQixLQUsxQmlCLEdBQ0FULEVBQWNwRixVQUdoQjFGLEVBQWM4QyxpQkFBaUIsU0FBUyxJQUFNb0ksRUFBYXhGLFNBRTNEdkYsRUFBTzJDLGlCQUFpQixTQUFTLElBQU1zSSxFQUFrQjFGLFMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBGb3JtIHZhbGlkYXRpb24gb2JqZWN0ICovXHJcblxyXG5jb25zdCBjb25maWdPYmplY3QgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIuZm9ybV9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJmb3JtX19lcnJvcl92aXNpYmxlXCJcclxufVxyXG5cclxuLyogSW5pdGlhbCBjYXJkcyBhcnJheSovXHJcblxyXG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgICBhbHQ6IFwiQSByaXZlciB3aXRoIGZvcmVzdCBvbiB0aGUgYmFua3MsIG1vdW50YWlucyBpbiB0aGUgYmFja2dyb3VuZFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gICAgYWx0OiBcIkEgbGFrZSBzdXJyb3VuZGVkIGJ5IG1vdW50YWlucyBhbmQgZm9yZXN0XCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgICBhbHQ6IFwiU3VucmlzZSBhYm92ZSBkYXJrIGhpbGxzXCJcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gICAgYWx0OiBcIlN0YXJyeSBuaWdodCwgbW91bnRhaW5zIHdpdGggcGllY2Ugb2Ygc25vd1wiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gICAgYWx0OiBcIkNvYXN0IG9mIGxha2UsIG1vdW50YWlucyBvbiB0aGUgYmFja2dyb3VuZFwiXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnXCIsXHJcbiAgICBhbHQ6IFwiU21hbGwgZG9jayB3aXRoIGxpdHRsZSBib2F0cyBvbiB0aGUgbW91bnRhaW4gbGFrZVwiXHJcbiAgfVxyXG5dO1xyXG5cclxuLyogRWRpdCBmb3JtIGNvbnN0YW50cyAqL1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcclxuY29uc3QgZWRpdFByb2ZpbGVGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm1fdHlwZV9lZGl0Jyk7XHJcbmNvbnN0IHBvcHVwSW5wdXROYW1lID0gZWRpdFByb2ZpbGVGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19pbnB1dF90eXBlX25hbWUnKTtcclxuY29uc3QgcG9wdXBJbnB1dEluZm8gPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX2lucHV0X3R5cGVfaW5mbycpO1xyXG5cclxuLyogQWRkIGNhcmQgZm9ybSBjb25zdGFudHMgKi9cclxuXHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5jb25zdCBhZGRDYXJkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX3R5cGVfYWRkLWNhcmQnKTtcclxuXHJcbi8qIENoYW5nZSBwcm9maWxlIHBpY3R1cmUgZm9ybSBjb25zdGFudHMgKi9cclxuXHJcbmNvbnN0IGNoYW5nZUF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybV90eXBlX2VkaXQtYXZhdGFyJyk7XHJcblxyXG4vKiBVc2VyIHByb2ZpbGUgKi9cclxuXHJcbmNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hdmF0YXInKTtcclxuXHJcblxyXG5leHBvcnQgeyBcclxuICAgICAgICBjb25maWdPYmplY3QsIFxyXG4gICAgICAgIGluaXRpYWxDYXJkcywgXHJcbiAgICAgICAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgICAgICAgZWRpdFByb2ZpbGVGb3JtLFxyXG4gICAgICAgIHBvcHVwSW5wdXROYW1lLFxyXG4gICAgICAgIHBvcHVwSW5wdXRJbmZvLFxyXG4gICAgICAgIGFkZENhcmRCdXR0b24sXHJcbiAgICAgICAgYWRkQ2FyZEZvcm0sXHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICAgIGNoYW5nZUF2YXRhckZvcm1cclxuICAgICAgIH07IiwiLyogQ2xhc3MgQ2FyZDpcclxuLSBjcmVhdGluZyBhIGNhcmQgZWxlbWVudDtcclxuLSBjYXJkIGdlbmVyYXRpb247XHJcbi0gZXZlbnQgbGlzdGVuZXJzOiBsaWtlIGJ1dHRvbiwgZGVsZXRlIGJ1dHRvbiwgb3BlbiBtb2RhbCB3aW5kb3cgKi9cclxuXHJcbmNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKGNhcmREYXRhLCB1c2VySWQsIG93bmVySWQsIHRlbXBsYXRlU2VsZWN0b3IsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlTGlrZUJ1dHRvbiwgaGFuZGxlRGVsZXRlQ2FyZEJ1dHRvbikge1xyXG4gICAgdGhpcy5faW1hZ2UgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5fdGl0bGUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fYWx0ID0gY2FyZERhdGEuYWx0O1xyXG4gICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIHRoaXMuX2lkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IG93bmVySWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSB0ZW1wbGF0ZVNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbiA9IGhhbmRsZUxpa2VCdXR0b247XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkQnV0dG9uID0gaGFuZGxlRGVsZXRlQ2FyZEJ1dHRvbjtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKS5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkJykuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgLy8gX2hhbmRsZUxpa2VCdXR0b24gPSAoZXZ0KSA9PiB7XHJcbiAgLy8gICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgLy8gfVxyXG5cclxuICBpc0xpa2VkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2xpa2VzLmZpbmQodXNlciA9PiB1c2VyLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIHNldExpa2VzKGxpa2VzKSB7XHJcbiAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG4gICAgY29uc3QgbGlrZXNBbW91bnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJykudGV4dENvbnRlbnQgPSBsaWtlc0Ftb3VudDtcclxuXHJcbiAgICAvLyBjb25zdCBjYXJkSXNMaWtlZEJ5VXNlciA9IHRoaXMuaXNMaWtlZDtcclxuXHJcbiAgICBpZih0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZScpLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZScpLmNsYXNzTGlzdC5yZW1vdmUoJ2NhcmRfX2xpa2VfYWN0aXZlJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuIGRlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGRlbGV0ZUNhcmRCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpO1xyXG4gICAgZGVsZXRlQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRCdXR0b24oKSk7XHJcblxyXG4gICAgY29uc3QgbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlJyk7XHJcbiAgICBsaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcblxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX3BpY3R1cmUnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX2hhbmRsZUNhcmRDbGljayk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICBcclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19waWN0dXJlJyk7XHJcbiAgICBjb25zdCBjYXJkRGVzY3JpcHRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVzY3JpcHRpb24nKTtcclxuXHJcbiAgICB0aGlzLnNldExpa2VzKHRoaXMuX2xpa2VzKTtcclxuXHJcbiAgICBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2RlbGV0ZS1idXR0b24nKTtcclxuICAgIGlmKCEodGhpcy5fdXNlcklkID09PSB0aGlzLl9vd25lcklkKSkge1xyXG4gICAgICBjYXJkRGVsZXRlQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2NhcmRfX2RlbGV0ZS1idXR0b25fZGlzYWJsZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5faW1hZ2U7XHJcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fYWx0O1xyXG4gICAgY2FyZERlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBDYXJkIH07IiwiLyogQ2xhc3MgZm9yIGZvcm1zIHZhbGlkYXRpb24gKi9cclxuXHJcbmV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWdPYmplY3QsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb25maWcgPSBjb25maWdPYmplY3Q7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9jb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yIChpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZmlnLmVycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBcclxuICBfaGlkZUlucHV0RXJyb3IgKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmZpZy5lcnJvckNsYXNzKTtcclxuICB9XHJcbiAgXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eSAoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgX2hhc0ludmFsaWRJbnB1dCAoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KVxyXG4gIH1cclxuICBcclxuICBfc2V0QnV0dG9uVG9EaXNhYmxlZFN0YXRlICgpIHtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcbiAgXHJcbiAgX3NldEJ1dHRvblRvRW5hYmxlZFN0YXRlICgpIHtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG4gIFxyXG4gIF9jaGFuZ2VCdXR0b25TdGF0ZSAoaW5wdXRMaXN0KSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fc2V0QnV0dG9uVG9EaXNhYmxlZFN0YXRlKHRoaXMuX2J1dHRvbkVsZW1lbnQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2V0QnV0dG9uVG9FbmFibGVkU3RhdGUodGhpcy5fYnV0dG9uRWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIF9zZXRFdmVudExpc3RlbmVycyAoKSB7XHJcbiAgICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fY29uZmlnLmlucHV0U2VsZWN0b3IpKTtcclxuICAgIHRoaXMuX2NoYW5nZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XHJcbiAgXHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KVxyXG4gICAgICAgIHRoaXMuX2NoYW5nZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgdGhpcy5fYnV0dG9uRWxlbWVudCk7XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gIH1cclxuICBcclxuICBlbmFibGVWYWxpZGF0aW9uICgpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IGV2dC5wcmV2ZW50RGVmYXVsdCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuICBcclxuICByZXNldEZvcm1WYWxpZGF0aW9uICgpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IgKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KVxyXG4gICAgdGhpcy5fc2V0QnV0dG9uVG9EaXNhYmxlZFN0YXRlKCk7XHJcbiAgfVxyXG59IiwiZXhwb3J0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdwb3B1cF9vcGVuZWQnKTtcclxuICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhbmRsZU1vdXNlQ2xpY2sgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwJykgfHwgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX19jbG9zZS1idXR0b24nKSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5faGFuZGxlTW91c2VDbGljayk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX2hhbmRsZU1vdXNlQ2xpY2spO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0LCBmb3JtVmFsaWRhdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm1WYWxpZGF0b3IgPSBmb3JtVmFsaWRhdG9yO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuICB9XHJcblxyXG4gIGdldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZvcm1fX2lucHV0JykpO1xyXG4gICAgY29uc3QgdmFsdWVzT2JqZWN0ID0ge307XHJcbiAgICBpbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgIHZhbHVlc09iamVjdFtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gdmFsdWVzT2JqZWN0O1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIHRoaXMuX2Zvcm1WYWxpZGF0b3IucmVzZXRGb3JtVmFsaWRhdGlvbigpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRGdW5jdGlvbigpO1xyXG4gICAgICAvLyB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn0iLCIvLyBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXHJcbi8vIFRva2VuOiBjMGQwNzA5MC04YzgwLTQ5YzItYWE3YS1jZDU2NzdhMzQ5ODRcclxuLy8gR3JvdXAgSUQ6IGNvaG9ydC0zLWVuXHJcblxyXG5jbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlci9tZScsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgfSlcclxuICAgICAgLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKSlcclxuICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcycsIHtoZWFkZXJzOiB0aGlzLl9oZWFkZXJzfSlcclxuICAgICAgLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKSlcclxuICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQobmFtZSxsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMnLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rIFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuKHJlcyA9PiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCkpXHJcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgfVxyXG5cclxuICBhZGRMaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvbGlrZXMvJyArIGlkLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnNcclxuICAgIH0pXHJcbiAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApKVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gIH1cclxuXHJcbiAgcmVtb3ZlTGlrZShpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyAnL2NhcmRzL2xpa2VzLycgKyBpZCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzXHJcbiAgICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHJlcy5vayA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKSlcclxuICAgIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcy8nICsgaWQsIHtcclxuICAgICAgbWV0aG9kOiAnREVMRVRFJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVyc1xyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlUGhvdG8oYXZhdGFyKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUvYXZhdGFyJywge1xyXG4gICAgICBtZXRob2Q6ICdQQVRDSCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXJcclxuICAgICAgfSlcclxuICAgIH0pXHJcbiAgICAudGhlbihyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApKVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG4gIGVkaXRQcm9maWxlSW5mbyhuYW1lLGFib3V0KSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlci9tZScsIHtcclxuICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dFxyXG4gICAgICB9KVxyXG4gICAgfSlcclxuICAgIC50aGVuIChyZXMgPT4gcmVzLm9rID8gcmVzLmpzb24oKSA6IFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApKVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9jb2hvcnQtMy1lbicsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJjMGQwNzA5MC04YzgwLTQ5YzItYWE3YS1jZDU2NzdhMzQ5ODRcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTsiLCJpbXBvcnQgJy4vaW5kZXguY3NzJztcclxuaW1wb3J0IHsgXHJcbiAgICAgICAgY29uZmlnT2JqZWN0LCBcclxuICAgICAgICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICAgICAgICBlZGl0UHJvZmlsZUZvcm0sXHJcbiAgICAgICAgcG9wdXBJbnB1dE5hbWUsXHJcbiAgICAgICAgcG9wdXBJbnB1dEluZm8sXHJcbiAgICAgICAgYWRkQ2FyZEJ1dHRvbixcclxuICAgICAgICBhZGRDYXJkRm9ybSxcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgICAgY2hhbmdlQXZhdGFyRm9ybVxyXG4gICAgICB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50cy5qcyc7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xyXG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzJztcclxuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcyc7XHJcbmltcG9ydCB7IFBvcHVwV2l0aENvbmZpcm1hdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzJztcclxuaW1wb3J0IHsgUG9wdXBXaXRoSW1hZ2UgfSBmcm9tICcuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzJztcclxuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XHJcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XHJcbmltcG9ydCB7IGFwaSB9IGZyb20gJy4uL2NvbXBvbmVudHMvQXBpLmpzJztcclxuXHJcbi8qIEZvcm1zIHZhbGlkYXRpb24gKi9cclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZ09iamVjdCxlZGl0UHJvZmlsZUZvcm0pO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnT2JqZWN0LCBhZGRDYXJkRm9ybSk7XHJcbmNvbnN0IGNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWdPYmplY3QsY2hhbmdlQXZhdGFyRm9ybSk7XHJcblxyXG4oZnVuY3Rpb24gc2V0Rm9ybXNWYWxpZGF0b3IoKSB7XHJcbiAgZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICBhZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxufSkoKTtcclxuXHJcbi8qIFN1YiBmdW5jdGlvbnMgKi9cclxuXHJcbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9IChpdGVtKSA9PiB7XHJcbiAgaW1hZ2VQb3B1cC5vcGVuKGl0ZW0ubGluaywgaXRlbS5uYW1lKTtcclxufSBcclxuXHJcbmxldCBjYXJkVG9EZWxldGU7XHJcblxyXG5jb25zdCByZW5kZXJDYXJkID0gKGl0ZW0pID0+IHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBpdGVtLCBcclxuICAgIHVzZXJJZCxcclxuICAgIGl0ZW0ub3duZXIuX2lkLFxyXG4gICAgJyNjYXJkJywgXHJcbiAgICAoKSA9PiBoYW5kbGVDYXJkQ2xpY2soaXRlbSksIFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcclxuICAgICAgICBhcGkucmVtb3ZlTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KSBcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBhcGkuYWRkTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICBjYXJkLnNldExpa2VzKHJlcy5saWtlcyk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gICAgKCkgPT4ge1xyXG4gICAgICBkZWxldGVDYXJkU3VibWlzc2lvblBvcHVwLm9wZW4oKTtcclxuICAgICAgY2FyZFRvRGVsZXRlID0gY2FyZDtcclxuICAgIH0pO1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuXHJcbi8qIFBhZ2UgaW5pdGlhbGl6YXRpb24gKi9cclxuXHJcbmNvbnN0IGNhcmRzU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHtcclxuICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgIGNhcmRzU2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQoaXRlbSkpO1xyXG4gICAgXHJcbiAgfVxyXG59LCAnLmdhbGxlcnlfX2xpc3QnKTtcclxuXHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuUHJvbWlzZS5hbGwoW2FwaS5nZXRVc2VySW5mbygpLCBhcGkuZ2V0SW5pdGlhbENhcmRzKCldKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xyXG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgYXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuXHJcbiAgICBjYXJkc1NlY3Rpb24ucmVuZGVyQ2FyZHMoY2FyZHMpO1xyXG4gIH0pXHJcblxyXG4vKiBDcmVhdGluZyBjbGFzc2VzIGluc3RhbmNlcyBhbmQgc2V0dGluZyBldmVudCBsaXN0ZW5lcnMgKi9cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKCcucHJvZmlsZV9fbmFtZScsICcucHJvZmlsZV9fYWJvdXQnKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF90eXBlX3BpY3R1cmUnKTtcclxuXHJcbmZ1bmN0aW9uIHJlbmRlckxvYWRpbmcoYnV0dG9uKSB7XHJcbiAgY29uc3QgYnV0dG9uVGV4dCA9IGJ1dHRvbi50ZXh0Q29udGVudDtcclxuICBidXR0b24udGV4dENvbnRlbnQgPSAnU2F2aW5nLi4uJztcclxuICByZXR1cm4gYnV0dG9uVGV4dDtcclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuY29uc3QgZWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXBfdHlwZV9lZGl0JywgKCkgPT4ge1xyXG4gIGNvbnN0IGZvcm1CdXR0b24gPSBlZGl0UHJvZmlsZUZvcm0ucXVlcnlTZWxlY3RvcignLmZvcm1fX3N1Ym1pdC1idXR0b24nKVxyXG4gIGNvbnN0IGZvcm1CdXR0b25UZXh0ID0gcmVuZGVyTG9hZGluZyhmb3JtQnV0dG9uKTtcclxuXHJcbiAgYXBpLmVkaXRQcm9maWxlSW5mbyhlZGl0Rm9ybVBvcHVwLmdldElucHV0VmFsdWVzKCkpXHJcbiAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgZWRpdEZvcm1Qb3B1cC5jbG9zZSgpO1xyXG4gICAgICBmb3JtQnV0dG9uLnRleHRDb250ZW50ID0gZm9ybUJ1dHRvblRleHRcclxuICAgIH0pXHJcbn0sIGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvcik7XHJcbmVkaXRGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2FkZC1jYXJkJywgKCkgPT4ge1xyXG4gIGNvbnN0IG5ld0NhcmRWYWx1ZXMgPSBhZGRDYXJkUG9wdXAuZ2V0SW5wdXRWYWx1ZXMoKTtcclxuXHJcbiAgY29uc3QgZm9ybUJ1dHRvbiA9IGFkZENhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19zdWJtaXQtYnV0dG9uJylcclxuICBjb25zdCBmb3JtQnV0dG9uVGV4dCA9IHJlbmRlckxvYWRpbmcoZm9ybUJ1dHRvbik7XHJcblxyXG4gIGFwaS5hZGRDYXJkKG5ld0NhcmRWYWx1ZXMubmFtZSwgbmV3Q2FyZFZhbHVlcy5saW5rKVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgY2FyZHNTZWN0aW9uLmFkZEl0ZW0ocmVuZGVyQ2FyZChyZXMpKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBmb3JtQnV0dG9uLnRleHRDb250ZW50ID0gZm9ybUJ1dHRvblRleHRcclxuICAgIH0pXHJcbiAgbmV3Q2FyZFZhbHVlcy5hbHQgPSBgSGVyZSB3YXMgYSBiZWF1dGlmdWwgcGljdHVyZSBvZiAke25ld0NhcmRWYWx1ZXMubmFtZX1gO1xyXG59LCBhZGRGb3JtVmFsaWRhdG9yKTtcclxuXHJcbmNvbnN0IGNoYW5nZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cF90eXBlX2VkaXQtYXZhdGFyJywgKCkgPT4ge1xyXG4gIGNvbnN0IGZvcm1CdXR0b24gPSBjaGFuZ2VBdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19zdWJtaXQtYnV0dG9uJylcclxuICBjb25zdCBmb3JtQnV0dG9uVGV4dCA9IHJlbmRlckxvYWRpbmcoZm9ybUJ1dHRvbik7XHJcblxyXG4gIGFwaS5lZGl0UHJvZmlsZVBob3RvKGNoYW5nZUF2YXRhclBvcHVwLmdldElucHV0VmFsdWVzKCkuYXZhdGFyKVxyXG4gICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgYXZhdGFyLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBjaGFuZ2VBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBmb3JtQnV0dG9uLnRleHRDb250ZW50ID0gZm9ybUJ1dHRvblRleHQ7XHJcbiAgICB9KVxyXG59LCBjaGFuZ2VBdmF0YXJGb3JtVmFsaWRhdG9yKTtcclxuY2hhbmdlQXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRTdWJtaXNzaW9uUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKCcucG9wdXBfdHlwZV9kZWxldGUtY2FyZCcsICgpID0+IHtcclxuICBhcGkuZGVsZXRlQ2FyZChjYXJkVG9EZWxldGUuZ2V0SWQoKSlcclxuICAgIC5maW5hbGx5KGRlbGV0ZUNhcmRTdWJtaXNzaW9uUG9wdXAuY2xvc2UoKSk7XHJcbiAgY2FyZFRvRGVsZXRlLmRlbGV0ZUNhcmQoKTtcclxufSk7XHJcbmRlbGV0ZUNhcmRTdWJtaXNzaW9uUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbi8qIEV2ZW50IGxpc3RlbmVycyBmb3Igb3BlbmluZyBtb2RhbCB3aW5kb3dzICovXHJcblxyXG5jb25zdCBmaWxsUHJvZmlsZUluZm9Gb3JtID0gKCkgPT4ge1xyXG4gIGNvbnN0IGluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHBvcHVwSW5wdXROYW1lLnZhbHVlID0gaW5mby5uYW1lO1xyXG4gIHBvcHVwSW5wdXRJbmZvLnZhbHVlID0gaW5mby5qb2I7XHJcbn1cclxuXHJcbihmdW5jdGlvbiBzZXRNb2RhbHNFdmVudExpc3RlbmVycygpIHtcclxuICBwcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGZpbGxQcm9maWxlSW5mb0Zvcm0oKTtcclxuICAgIGVkaXRGb3JtUG9wdXAub3BlbigpXHJcbiAgfSk7XHJcblxyXG4gIGFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBhZGRDYXJkUG9wdXAub3BlbigpKTtcclxuXHJcbiAgYXZhdGFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gY2hhbmdlQXZhdGFyUG9wdXAub3BlbigpKTtcclxufSkoKTtcclxuXHJcbiIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IC8qaXRlbXMsKi8gcmVuZGVyZXIgfSwgc2VjdGlvblNlbGVjdG9yKSB7XHJcbiAgICAvLyB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX3NlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlY3Rpb25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX3NlY3Rpb24uYXBwZW5kKGl0ZW0pO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyQ2FyZHMoaXRlbXMpIHtcclxuICAgIGl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSlcclxuICB9XHJcbn0iLCJleHBvcnQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX25hbWVGaWVsZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2pvYkZpZWxkID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2JTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7IG5hbWU6IHRoaXMuX25hbWVGaWVsZC50ZXh0Q29udGVudCwgam9iOiB0aGlzLl9qb2JGaWVsZC50ZXh0Q29udGVudCB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8odXNlcikge1xyXG4gICAgdGhpcy5fbmFtZUZpZWxkLnRleHRDb250ZW50ID0gdXNlci5uYW1lO1xyXG4gICAgdGhpcy5fam9iRmllbGQudGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xyXG4gIH1cclxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSAnLi9Qb3B1cC5qcyc7XHJcblxyXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKGltYWdlLCBkZXNjcmlwdGlvbikge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gICAgY29uc3QgcG9wdXBQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXBpY3R1cmUtYm94X19pbWFnZScpO1xyXG4gICAgY29uc3QgcG9wdXBDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLXBpY3R1cmUtYm94X19jYXB0aW9uJyk7XHJcbiAgICBwb3B1cFBpY3R1cmUuc3JjID0gaW1hZ2U7XHJcbiAgICBwb3B1cFBpY3R1cmUuYWx0ID0gYEhlcmUgd2FzIGEgYmVhdXRpZnVsIHBpY3R1cmUgb2YgJHtkZXNjcmlwdGlvbn1gO1xyXG4gICAgcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG59IiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvciwgc3VibWl0RnVuY3Rpb24pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc3VibWl0RnVuY3Rpb24gPSBzdWJtaXRGdW5jdGlvbjtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9zdWJtaXRGdW5jdGlvbigpO1xyXG4gICAgICAvLyB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn0iXSwibmFtZXMiOlsiY29uZmlnT2JqZWN0IiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImVkaXRQcm9maWxlRm9ybSIsInBvcHVwSW5wdXROYW1lIiwicG9wdXBJbnB1dEluZm8iLCJhZGRDYXJkQnV0dG9uIiwiYWRkQ2FyZEZvcm0iLCJjaGFuZ2VBdmF0YXJGb3JtIiwiYXZhdGFyIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiY2FyZERhdGEiLCJ1c2VySWQiLCJvd25lcklkIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZUxpa2VCdXR0b24iLCJoYW5kbGVEZWxldGVDYXJkQnV0dG9uIiwidGhpcyIsIl9pbWFnZSIsImxpbmsiLCJfdGl0bGUiLCJuYW1lIiwiX2FsdCIsImFsdCIsIl9saWtlcyIsImxpa2VzIiwiX2lkIiwiX3VzZXJJZCIsIl9vd25lcklkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDYXJkQnV0dG9uIiwiZ2V0SWQiLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiaXNMaWtlZCIsImZpbmQiLCJ1c2VyIiwic2V0TGlrZXMiLCJsaWtlc0Ftb3VudCIsImxlbmd0aCIsIl9jYXJkRWxlbWVudCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiZGVsZXRlQ2FyZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJnZW5lcmF0ZUNhcmQiLCJjYXJkSW1hZ2UiLCJjYXJkRGVzY3JpcHRpb24iLCJjYXJkRGVsZXRlQnV0dG9uIiwic3JjIiwiRm9ybVZhbGlkYXRvciIsImZvcm1FbGVtZW50IiwiX2NvbmZpZyIsIl9mb3JtRWxlbWVudCIsIl9idXR0b25FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0Iiwic29tZSIsImlucHV0IiwiX3NldEJ1dHRvblRvRGlzYWJsZWRTdGF0ZSIsImRpc2FibGVkIiwiX3NldEJ1dHRvblRvRW5hYmxlZFN0YXRlIiwiX2NoYW5nZUJ1dHRvblN0YXRlIiwiaW5wdXRMaXN0IiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0Rm9ybVZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMiLCJfaGFuZGxlTW91c2VDbGljayIsIl9oYW5kbGVFc2NDbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0IiwiZm9ybVZhbGlkYXRvciIsInN1cGVyIiwiX2hhbmRsZVN1Ym1pdCIsIl9mb3JtVmFsaWRhdG9yIiwiZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXNPYmplY3QiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfc3VibWl0RnVuY3Rpb24iLCJhcGkiLCJvcHRpb25zIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwiZ2V0SW5pdGlhbENhcmRzIiwiYWRkQ2FyZCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkTGlrZSIsInJlbW92ZUxpa2UiLCJlZGl0UHJvZmlsZVBob3RvIiwiZWRpdFByb2ZpbGVJbmZvIiwiYWJvdXQiLCJhdXRob3JpemF0aW9uIiwiZWRpdFByb2ZpbGVGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImNoYW5nZUF2YXRhckZvcm1WYWxpZGF0b3IiLCJjYXJkVG9EZWxldGUiLCJyZW5kZXJDYXJkIiwiaXRlbSIsImNhcmQiLCJvd25lciIsImltYWdlUG9wdXAiLCJkZWxldGVDYXJkU3VibWlzc2lvblBvcHVwIiwiY2FyZHNTZWN0aW9uIiwic2VjdGlvblNlbGVjdG9yIiwicmVuZGVyZXIiLCJfcmVuZGVyZXIiLCJfc2VjdGlvbiIsImFkZEl0ZW0iLCJhcHBlbmQiLCJyZW5kZXJDYXJkcyIsIml0ZW1zIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRmllbGQiLCJfam9iRmllbGQiLCJqb2IiLCJpbWFnZSIsImRlc2NyaXB0aW9uIiwicG9wdXBQaWN0dXJlIiwicG9wdXBDYXB0aW9uIiwicmVuZGVyTG9hZGluZyIsImJ1dHRvbiIsImJ1dHRvblRleHQiLCJlZGl0Rm9ybVBvcHVwIiwiZm9ybUJ1dHRvbiIsImZvcm1CdXR0b25UZXh0IiwiZmluYWxseSIsImFkZENhcmRQb3B1cCIsIm5ld0NhcmRWYWx1ZXMiLCJjaGFuZ2VBdmF0YXJQb3B1cCIsInN1Ym1pdEZ1bmN0aW9uIiwiaW5mbyIsImZpbGxQcm9maWxlSW5mb0Zvcm0iXSwic291cmNlUm9vdCI6IiJ9